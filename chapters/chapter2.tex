%%==================================================
%% chapter2.tex for BIT Master Thesis
%% version: 0.1
%% last update: Nov 8th, 2017
%%==================================================
\chapter{半参数系统与信息浓缩估计}
\label{chap:2}
传统鲁棒控制主要考虑小范围的结构不确定性，传统自适应控制主要考虑系统的参数不确定性，而一般的非线性自适应控制直接考虑非线性模型从而设计复杂的控制器。实际问题中参数不确定性和较大的结构不确定性可同时出现，因此这些方法对于解决非线性不确定性被控对象的离散时间控制问题都存在一定的局限性。所有的被控对象本质上都是非线性的，但是线性控制方法在反馈控制前期发展中起到了很大作用。这不由得让人思考，是否很多非线性对象都存在一个起主要作用的线性模型？按照这个思路，虽然无法精确的已知非线性不确定性系统的离散化模型，但是这些非线性系统可以用一个线性模型（如ARX模型）加上一个非线性部分（关于输入输出数据的未知函数）近似，也就是把系统的不确定性分为参数和非参数不确定性。为了解决控制问题，需要先辨识参数部分。这就是本章要介绍的半参数系统和所谓的信息浓缩（information concentration estimate, IC）估计。

\section{反馈机制极限的探索}
\label{sect:2.1}
不管是采用连续时间模型还是离散时间角度设计控制律，实际系统都会存在无法预测的不确定性，如干扰、未建模动态等，这会导致输出就会产生偏差。反馈从一开始就是为了解决这种偏差和不确定性而引入的。传统针对线性时不变系统设计的控制方法属于线性反馈。然而，即便是针对ARX模型设计的自校正调节器，自适应控制从本质上说是一种非线性反馈\upcite{Guo2003}。当系统存在不确定性时，在设计自适应辨识与控制算法时，是否一定存在一种自适应控制律能够使得系统闭环稳定？这是在设计自适应控制之前首先要回答的问题。然而直到20世纪90年代末，郭雷院士等学者开始探索反馈机制\upcite{Guo1997}，创造性地提出反馈机制的最大能力和局限（the limit to the capability of feedback）这一重要命题，并针对一些基本控制系统的自适应反馈极限进行定量研究，才引起来广泛的关注。

最开始关于反馈机制的研究始于一类基本的不确定非线性系统，即下面的模型\eqref{eq:Guo1}
\begin{equation}%
\label{eq:Guo1}
y_{k+1} = \theta \phi_{k} + u_{k} + \omega_{k+1},\ \phi_{k}=O(y_{k}^{b}),\ b>0
\end{equation}
其中，$u_{k}$和$y_{k}$分别是系统在$k$时刻的输入和输出，一般假定$\omega_{k}$为高斯白噪声干扰。$\theta$是未知参数，$b$刻画了系统非线性的增长速率。除了参数不确定性$\theta$外，系统\eqref{eq:Guo1}的不确定性主要表现为$\phi_{k}$的未知性，即非参数不确定性。经过严格的数学证明，当$b\geq4$时，不存在任何的自适应反馈控制律使得系统\eqref{eq:Guo1}满足全局稳定。进一步考虑如下的系统：
\begin{equation}%
\label{eq:Guo2}
y_{k+1} = f(y_{k}) + u_{k} + \omega_{k+1},\ f(\dot)\in F(L)
\end{equation}
其中，$f(\cdot)$是未知函数，$F(L)$代表一类满足Lipschitz条件的非线性函数。对于这种非参数不确定性系统，有如下结论\upcite{XieGuo2000}：如果$L<\frac32+\sqrt{2}$，则存在反馈控制律使得系统\eqref{eq:Guo2}全局稳定；相反，若$L\geq\frac32+\sqrt{2}$，则不存在反馈控制律使得系统\eqref{eq:Guo2}全局稳定。$f(\cdot)$的绝对值随自变量$y_{k}$绝对值的增长速率决定了反馈机制能力的上限。

上述这些现象在连续时间非线性系统中至今没有表现出来，这说明离散时间控制研究的必要性。这些“不可能性”（impossibility）定理表明了，在离散时间非线性系统的自适应控制中反馈机制存在极限。在随后的研究\upcite{Guo2002,ZhangGuo2002}中将这“不可能性”定理一推广到了高阶情形，其中$f(\cdot)$就推广到了多元函数，同样是满足Lipschitz条件。可以这样理解，如果$f(\cdot)$增长的比较快，那么就不存在使得系统\eqref{eq:Guo1}趋于稳定的自适应反馈控制律。分析出反馈机制的上下并给出数学证明，确实不是一件容易的事情。这一理论很直观地说明了系统的不确定性的大小常常表现为系统未知函数或者参数的变化剧烈程度，这些结论从控制稳定性和可行性的角度对系统的不确定性给出了一定的定量描述。

目前关于反馈机制及能力的研究主要针对离散时间控制系统，这与离散时间控制器的广泛应用这一大趋势不谋而合，并且一开始就考虑到了非参数不确定性，因而具有较好的理论高度和普适性。反馈机制及能力给出了对不确定性系统的认识，从理论上看，不是所有的未知系统都可以设计出稳定的自适应控制律\upcite{Ma2008}；用但是同时也留下了一个问题：如果系统属于自适应反馈控制可稳定的范围内，那么如何设计出合适的自适应反馈控制律使系统达到满意的性能？一般来说，不同的被控对象自然结构和参数都不同，但是否存在一种较为通用的模型可以刻画大部分面对的被控对象？可以类比经典控制理论，毕竟线性系统和微分方程这些通用工具在几十年的控制理论中起到了关键的作用。类似这样的问题促进了半参数模型的提出。

\section{半参数系统的描述}
\label{sect:2.2}
虽然数字化控制器输出到被控对象的信号是离散时间，但是实际的过程是连续时间变化的。一般的离散时间非线性控制往往忽略了这一点，就导致这些研究侧重于理论和离散时间仿真分析。再次考虑下面的NARX系统
\begin{equation}%
\label{eq:NARX2}
y_{k+1} = f(y_{K},y_{k-1},\ldots,y_{k+1-p},u_{k},u_{k-1},\ldots,u_{k-q})+\omega_{k+1}
\end{equation}
在系统\eqref{eq:NARX2}中，把被控对象当成完全非线性模型，忽略了他们的线性特性，也就是说很多被控对象虽然具有较大的不确定性，但是在一定程度上是可以当作线性对象处理，只不过同时具有非线性部分，导致实际的线性部分参数与理论值有较大的偏差；对于不确定性系统，也就常常表现为同时具有参数不确定性和非参数不确定性。例如电机伺服系统简化处理就是一个二阶线性模型，一般的PID控制也可以获得还算不错的效果；只不过是在负载未知、快时变，或者一些难以建模的非线性动态特性如摩擦等严重的情况下，应用传统的PID控制电机伺服系统时，其效果才会大打折扣。

上述事实说明了实际系统表现出的线性特性有助于解决非线性自适应控制问题，不可忽视。这样看来，一般的非线性系统都可以看作是由线性部分和非线性部分组成。也就说是，在分析具有强非线性的不确定离散时间被控系统时，要同时考虑系统存在的参数不确定性和非参数不确定性。受反馈机制能力与极限等相关研究的启发，用半参数系统刻画非线性离散时间被控对象，然后基于半参数系统建立自适应控制律，是一种很自然的思路。

半参数系统的模型并不唯一。首先考虑如下一种半参数模型
\begin{equation}%
\label{eq:semi-u}
y_{k+1} = \theta^{T}\bm{\phi_{k}}+f(\phi_{k})+ u_{k}+\omega_{k+1}
\end{equation}
其中，$y_{k}$，$u_{k}$分别表示系统在$k$时刻的输出和输入，$\bm{\phi_{k}}$是回归向量。系统的输出$y_{k}$对应到实际的伺服电机系统中可能就是需要控制的电机转速或者位置等物理量，而$u_k$可能就是控制电流（或者控制力矩）等。$\bm{\theta}\in\Theta$是未知参数向量，$f(\cdot)\in\mathcal{F}$是未知函数，$\omega_{k}\in\Delta_{k}$是外部随机干扰；这里$\Theta$，$\mathcal{F}$，$\Delta_{k}$分别代表了参数不确定性$\bm{\theta}$，非参数不确定性$f(\cdot)$和随机干扰$\omega_{k}$的先验知识。他们都是集合的形式，即\mathcal{F}是函数集合、向量集合、数值集合。下面分别对这三个量列举一些先验知识的例子。

记
\begin{equation}%
\label{eq:}
\bm{\theta} = [\theta_{1},\ldots,\theta_{p}]^{T}
\end{equation}
未知参数向量$\bm{\theta}$具有很强的物理意义，例如对应到伺服电机系统中，$\bm{\theta}$中的某些分量可能就表示电机的力矩常数、电枢回路常数等。$\bm{\theta}$可能存在如下的某种先验知识：
\begin{itemize}
\item 除了向量的元素个数外，没有其他任何关于未知参数的信息如上下界等；
\item $\bm{\theta}$各分量的上下界已知，即$\underline{\theta}_{n}\leq\theta_{n}\leq\overline{\theta}_{n}$，其中$\underline{\theta}_{n}$和$\overline{\theta}_{n}$为已知常数向量；
\item 未知参数向量$\bm{\theta}$和标称向量$\bm{\theta}_{0}$之间的距离取值在一个范围内，即$\|\bm{\theta}-\bm{\theta}_{0}\|\leq r_{0}$，这里$r_{0}$是一个已知的常数。
\item 未知参数向量的取值有限可数，即$\bm{\theta}$属于某一个已知的集合，$\bm{\theta}\in\{\bm{\theta}_{1},\bm{\theta}_{2},\bm{\theta}_{3},\dots,\}$；
\item $\dots$
\end{itemize}

同理，未知函数$f(\cdot)$在实际系统如电机物理系统中，对应可能就是难以建模的非线性摩擦力（力矩）等。$f(\cdot)$可能存在如下的某种先验知识：
\begin{itemize}
\item $f(x)=0$对于任意的自变量$x$，这意味着系统不存在任何未建模动态特性；
\item $f(x)$的值受限于其他已知函数，即$\underline{f}(x)\leq f(x)\leq\overline{f}(x)$，其中$\underline{f}(x)$和$\overline{f}(x)$为已知函数；
\item 未知函数$f(x)$和标称函数$f_{0}(x)$之间的距离在某一个已知范围内内，即$\|f(x)-f_{0}(x)\|\leq r_{f}$，这里$r_{f}\geq0$是一个已知的常数，这里函数$f_{0}(x)$可以认为是定义在赋范可测函数空间集合$\mathcal{f}$的中心；
\item 未知函数的表达式有限可数，即$f(x)$属于某一个已知的函数集合，$f(x)\in\{f_{1}(x),f_{2}(x),f_{3}(x),\dots,\}$。
\item 未知函数$f(x)$是满足Lipschitz定义的，即存在某个常数$L_{f}\geq0$，使得$\|f(x_{1})-f(x_{2})\|\leq L\|x_{1}-x_{2}\|$成立；
\item 未知函数$f(x)$是相对于自变量来说是单调递增（或者递减）的；
\item 未知函数$f(x)$是凸函数（或者凹函数）;
\item $\dots$
\end{itemize}

未知随机干扰$\omega_{k}$可能存在如下的先验知识：
\begin{itemize}%
\item $\omega_{k}=0$对于任意的$k\geq0$，这意味着系统不存在随机干扰；
\item $\omega_{k}$的取值在一个已知的范围内，即上下界已知，$\underline{\omega}\leq\omega_{k}\leq\overline{\omega}$；
\item $\omega_{k}$的取值受限于其他已知的干扰序列，即$\underline{\omega}_{k}\leq\omega_{k}\leq\overline{\omega}_{k}$；
\item $\omega_{k}$的取值都来自于一个已知的集合，即$\omega_{k}\in\{e_{1}, e_{2},\ldots,e_{N}\}$；
\item $\omega_{k}$的统计特性符合某种概率分布；例如$\omega_{k}$是高斯随机过程，则$E(\omega_{k})=0$，$E(\omega_{k}^{2})=\sigma^{2}$；又比如$\omega_{k}$的取值满足均匀分布，即$\omega_{k}\sim U(0,1)$；
\item $\omega_{k}$是一个衰减的序列，如$\omega_{k}=\frac1{k^{2}}$；
\item $\dots$
\end{itemize}

\section{信息浓缩估计}
\label{sect:2.3}

参数估计算法

半参数自适应控制给出了一种新的理论框架，解决两种不确定性同时出现的系统。现有的半参数自适应控制实现了一维情形下的参数估计算法，但二阶及其以上的参数估计并未具体实现，这涉及计算几何的知识。因此设计高阶情形下基于信息浓缩思想的参数估计算法是实现半参数自适应控制的前提。